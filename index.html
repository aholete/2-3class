<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä»Šæ—¥ã®ãŠã¿ãã˜</title>
<style>
  body {
    font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
    text-align: center;
    margin-top: 100px;
    background: #fffaf0;
  }
  h1 {
    color: #d2691e;
  }
  button {
    padding: 12px 24px;
    font-size: 18px;
    background-color: #ffcc00;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
  #omikujiResult {
    margin-top: 30px;
    font-size: 20px;
  }
</style>
</head>
<body>

<h1>ä»Šæ—¥ã®ãŠã¿ãã˜</h1>
<button onclick="drawOmikuji()">ãŠã¿ãã˜ã‚’å¼•ã ğŸ´</button>
<div id="omikujiResult"></div>

<script>
const omikujiResults = [
  { name: "å¤§å‰", text: "æœ€é«˜ã®ä¸€æ—¥ã«ãªã‚Šãã†ï¼" },
  { name: "ä¸­å‰", text: "ã„ã„ã“ã¨ãŒã‚ã‚Šãã†ï¼" },
  { name: "å°å‰", text: "ã¡ã‚‡ã£ã¨è‰¯ã„ã“ã¨ãŒã‚ã‚‹ã‹ã‚‚ã€‚" },
  { name: "å‰",   text: "å¹³ç©ã§è‰¯ã„ä¸€æ—¥ã«ãªã‚Šãã†ã€‚" },
  { name: "å‡¶",   text: "ç„¡ç†ã›ãšã‚†ã£ãã‚Šéã”ãã†ã€‚" }
];

function getDrawCount() {
  return parseInt(localStorage.getItem("drawCount") || "0");
}

function incrementDrawCount() {
  const count = getDrawCount() + 1;
  localStorage.setItem("drawCount", count);
}

function getStoredResult() {
  return localStorage.getItem("secondResult");
}

function setStoredResult(resultHTML) {
  localStorage.setItem("secondResult", resultHTML);
}

function drawOmikuji() {
  const count = getDrawCount();
  const resultBox = document.getElementById("omikujiResult");
  resultBox.style.display = "block";

  // 3å›ç›®ä»¥é™ â†’ 2å›ç›®ã®çµæœã‚’è¡¨ç¤º
  if (count >= 2) {
    const stored = getStoredResult();
    if (stored) {
      resultBox.innerHTML = stored;
      return;
    }
  }

  incrementDrawCount();

  // é€šå¸¸ã®ãŠã¿ãã˜çµæœã‚’è¡¨ç¤º
  const r = Math.floor(Math.random() * omikujiResults.length);
  const result = omikujiResults[r];
  const resultHTML = `ä»Šæ—¥ã®é‹å‹¢ï¼š<strong>${result.name}</strong><br>${result.text}`;
  resultBox.innerHTML = resultHTML;

  // 2å›ç›®ã®çµæœã‚’ä¿å­˜
  if (count === 1) {
    setStoredResult(resultHTML);
  }
}
</script>

</body>
</html>

